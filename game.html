<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rain Game</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: black;
      font-family: Arial, sans-serif;
    }

    .scoreboard, .timer {
      position: absolute;
      font-size: 20px;
      color: white;
      padding: 10px;
      z-index: 1000;
    }

    .scoreboard {
      top: 10px;
      left: 10px;
    }

    .timer {
      top: 10px;
      right: 10px;
    }

    .droplet {
      position: absolute;
      cursor: pointer;
    }
  </style>
</head>
<body>
<div class="scoreboard">Score: 0</div>
<div class="timer">Time: 15s</div>

<script>
  const body = document.body;
  const scoreboard = document.querySelector('.scoreboard');
  const timer = document.querySelector('.timer');
  let score = 0;
  let timeLeft = 15;
  let gameInterval;
  let countdown;
  const droplets = [];

  function randomPosition(max) {
    return Math.random() * max;
  }

  function isOverlapping(newDroplet, x, y, width, height) {
    for (let droplet of droplets) {
      const rect = droplet.getBoundingClientRect();
      if (
              x < rect.right &&
              x + width > rect.left &&
              y < rect.bottom &&
              y + height > rect.top
      ) {
        return true;
      }
    }
    return false;
  }

  function createDroplet() {
    const droplet = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    const size = [70, 80, 90][Math.floor(Math.random() * 3)];
    const pointValue = { 70: 20, 80: 30, 90: 50 }[size];

    let x, y;
    let attempts = 0;
    const maxAttempts = 50;

    do {
      x = randomPosition(window.innerWidth - size);
      y = randomPosition(window.innerHeight - size * 1.5 - 50) + 50;
      attempts++;
    } while (
            (isOverlapping(droplet, x, y, size, size * 1.5) || y < 50) &&
            attempts < maxAttempts
            );

    if (attempts === maxAttempts) return; // Stop if unable to place droplet

    droplet.setAttribute("width", size);
    droplet.setAttribute("height", size * 1.5);
    droplet.setAttribute("viewBox", "0 0 400 400");
    droplet.style.position = "absolute";
    droplet.style.left = `${x}px`;
    droplet.style.top = `${y}px`;

    const defs = document.createElementNS("http://www.w3.org/2000/svg", "defs");
    const radialGradient = document.createElementNS("http://www.w3.org/2000/svg", "radialGradient");
    radialGradient.setAttribute("id", "test");
    radialGradient.setAttribute("gradientUnits", "userSpaceOnUse");
    radialGradient.setAttribute("r", "210");
    radialGradient.setAttribute("gradientTransform", "translate(-46 -28)");

    const stops = [
      { offset: "1%", color: "#72f2c7" },
      { offset: "65%", color: "#75d5f1" },
      { offset: "82%", color: "#75a1f3" },
      { offset: "87%", color: "#7c99f4" },
      { offset: "97%", color: "#d997ff" }
    ];

    stops.forEach(({ offset, color }) => {
      const stop = document.createElementNS("http://www.w3.org/2000/svg", "stop");
      stop.setAttribute("offset", offset);
      stop.setAttribute("stop-color", color);
      radialGradient.appendChild(stop);
    });

    defs.appendChild(radialGradient);

    const path1 = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path1.setAttribute("d", "M74,263 a50,50 0 0 1 -18,40 a2,2 0 0 1 -4,-4 a47,47 0 0 0 17,-36 a2.5,2.5 0 0 1 5,0");
    path1.setAttribute("fill", "#4d5cb1");

    const path2 = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path2.setAttribute("d", "M100,120 a140,140 0 1 0 198,0 c-26,-26 -44,-48 -44,-90 c-42,28 -128,64 -154,90");
    path2.setAttribute("fill", "url(#test)");
    path2.setAttribute("transform", "translate(40 -20) rotate(10)");

    const circles = [
      { cx: 140, cy: 210, r: 8, fill: "#4d5cb1" },
      { cx: 210, cy: 210, r: 8, fill: "#4d5cb1" },
      { cx: 124, cy: 232, r: 10, fill: "#ffc6d7" },
      { cx: 226, cy: 232, r: 10, fill: "#ffc6d7" }
    ];

    const circleElements = circles.map(({ cx, cy, r, fill }) => {
      const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
      circle.setAttribute("cx", cx);
      circle.setAttribute("cy", cy);
      circle.setAttribute("r", r);
      circle.setAttribute("fill", fill);
      return circle;
    });

    const path3 = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path3.setAttribute("d", "M160,230a22,22 0 0 0 30,0a3.5,3.5 0 0 0 -5,-5a15,15 0 0 1 -20,0a3.5,3.5 0 0 0 -5,5");
    path3.setAttribute("fill", "#4d5cb1");

    const path4 = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path4.setAttribute("d", "M321,263 a50,50 0 0 0 18,40 a2,2 0 0 0 4,-4 a47,47 0 0 1 -17,-36 a2.5,2.5 0 0 0 -5,0");
    path4.setAttribute("fill", "#4d5cb1");

    droplet.appendChild(defs);
    droplet.appendChild(path1);
    droplet.appendChild(path2);
    circleElements.forEach(circle => droplet.appendChild(circle));
    droplet.appendChild(path3);
    droplet.appendChild(path4);

    droplet.addEventListener('click', () => {
      score += pointValue;
      scoreboard.textContent = `Score: ${score}`;

      let position = parseFloat(droplet.style.top);
      const fallInterval = setInterval(() => {
        position += 5;
        droplet.style.top = `${position}px`;

        if (position > window.innerHeight) {
          droplet.remove();
          clearInterval(fallInterval);
        }
      }, 16);
    });

    body.appendChild(droplet);
    droplets.push(droplet);
  }

  function startGame() {
    gameInterval = setInterval(() => {
      createDroplet();
    }, 500);

    countdown = setInterval(() => {
      timeLeft--;
      timer.textContent = `Time: ${timeLeft}s`;

      if (timeLeft <= 0) {
        clearInterval(gameInterval);
        clearInterval(countdown);
        alert(`Game over! Your score is ${score}`);
      }
    }, 1000);
  }

  startGame();

  window.addEventListener("resize", () => {
    document.querySelectorAll("svg").forEach(droplet => {
      const maxWidth = window.innerWidth - parseFloat(droplet.getAttribute("width"));
      droplet.style.left = `${Math.min(parseFloat(droplet.style.left), maxWidth)}px`;
    });
  });
</script>
</body>
</html>
